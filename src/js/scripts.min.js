function get_filtered_url_search(){var e=window.location.search;if(url_vars=getUrlVars(),output="?","o"in url_vars){for(var t in url_vars)"o"!=t&&(output+="&"+t+"="+url_vars[t]);return output}return e}function openmodalContent(e,t,a){openmodal(t)}function openmodal(e){$("#"+e).addClass("js-active"),$("#"+e).animate({opacity:1},500),$(".modal-shadow").addClass("js-active"),$(".modal-shadow").animate({opacity:.5},500),modalresizer()}function modalresizer(){$(".modal-window").each(function(){var e=$(this);if(e.css({height:"auto"}),e.hasClass("js-active"))if(e.outerHeight()>=$(window).height())$("body").addClass("overflow-no").css("padding-right",scrollbarWidth()),$(".page-header").css("padding-right",scrollbarWidth()),e.css({top:0,height:"100%"});else{$("body").removeClass("overflow-no").css("padding-right","0px"),$(".page-header").css("padding-right","0px"),e.removeClass("js-window-absolut");var t=$(window).height(),a=e.innerHeight(),s=t-a;s/=2,e.css({top:s,height:"auto"})}})}function scrollbarWidth(){var e=$("<div>").css({height:"50px",width:"50px"}),t=$("<div>").css({height:"200px"});$("body").append(e.append(t));var a=$("div",e).innerWidth();e.css("overflow-y","scroll");var s=$("div",e).innerWidth();return $(e).remove(),a-s}function enableSubmit(){var e=$(".g-recaptcha").closest("form").find('button[type="submit"]');e.removeAttr("disabled"),e.removeClass("btn--disabled"),e.next().hide("slow")}function enableSubmit1(){var e=$("form.quick_order").find('button[type="submit"]');e.removeAttr("disabled"),e.removeClass("btn--disabled"),e.siblings(".help-text").slideUp("slow")}function show_range_slider(){$range.ionRangeSlider({type:"double",step:1e3,force_edges:!0,postfix:" р.",prettify:!0,onChange:function(e){$('input[name="min_price"]').val(e.from),$('input[name="max_price"]').val(e.to)},onUpdate:function(e){$('input[name="min_price"]').val(e.from),$('input[name="max_price"]').val(e.to)},onFinish:function(e){$('input[name="min_price"]').trigger("blur")}}),slider=$range.data("ionRangeSlider")}function validate(e){var t=e||window.event,a=t.keyCode||t.which;a=String.fromCharCode(a),/[0-9]|\./.test(a)||(t.returnValue=!1,t.preventDefault&&t.preventDefault())}function getUrlVars(){var e={};return window.location.search.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(t,a,s){e[a]=s}),e}function show_more(e){var t=e.find(".js-show-more-text");e.removeClass("open").removeClass("show").removeClass("close"),e.find(".js-show-more-btn").text("Показать полностью");var a=t.height();if(t.hasClass("show-more--text-min"))var s=42;else var s=184;a>s&&e.addClass("show").addClass("close")}function getCookie(e){var t=null;if(document.cookie&&""!=document.cookie)for(var a=document.cookie.split(";"),s=0;s<a.length;s++){var n=jQuery.trim(a[s]);if(n.substring(0,e.length+1)==e+"="){t=decodeURIComponent(n.substring(e.length+1));break}}return t}function setCookie(e,t){document.cookie=escape(e)+"="+escape(t)}function getNumEnding(e,t){var a;if((e%=100)>=11&&e<=19)a=t[2];else switch(e%10){case 1:a=t[0];break;case 2:case 3:case 4:a=t[1];break;default:a=t[2]}return a}function activate_chat(e,t,a,s,n,i){function o(){$("[data-chat-conversation]").scrollTop($("[data-chat-conversation]")[0].scrollHeight)}function r(){var e=new Audio;e.src="/static/bb2.mp3",e.autoplay=!0}function c(){var d=["websocket","xdr-streaming","xhr-streaming","iframe-eventsource","iframe-htmlfile","xdr-polling","xhr-polling","iframe-xhr-polling","jsonp-polling"];conn=new SockJS(s+":"+n+"/chat",d),conn.onopen=function(){i?(console.log("Connected to thread."),conn.send('{"type":"auth","thread_id":"'+e+'"}'),$("[data-chat-textarea]").focus()):(console.log("Connected to alert."),conn.send('{"type":"alert"}'))},conn.onmessage=function(e){var s=JSON.parse(e.data);if(console.log(s),"alert"==s.name&&(console.log("alert"),$(".messenger__alert-wrap").show(),$(".messenger__alert-wrap a").attr("href",location.origin+"/accounts/messenger/chat/"+s.thread+"/")),"message"==s.name){$("[data-chat-typing]").fadeOut();var n=new Date(1e3*s.timestamp),i=$.map([n.getDate(),n.getMonth()+1,n.getFullYear(),n.getHours(),n.getMinutes(),n.getSeconds()],function(e,t){return e<10?"0"+e:e});if(s.sender==t)var c=$("#chat-template-right").html();else var c=$("#chat-template-left").html();Mustache.parse(c);var d=Mustache.render(c,{message:s.text.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br />"),username:s.sender,profile_name:s.profile_name,date:i[0]+"."+i[1]+"."+i[2]+" "+i[3]+":"+i[4]+":"+i[5]});$("[data-chat-messages]").append(d),o(),a.total++,s.sender==t?a.sent++:(a.received++,r(),$("[data-chat-textarea]").is(":focus")&&conn.send('{"type":"viewed"}')),$("[data-chat-info]").html(a.total+" "+getNumEnding(a.total,["сообщение","сообщения","сообщений"])+" ("+a.received+" получено, "+a.sent+" отправлено)")}"typing"==s.name&&(console.log(s.sender+" "+t),s.sender!=t&&(s.typing?(console.log("Печатает..."),$("[data-chat-typing]").text("Печатает..."),$("[data-chat-typing]").fadeIn(),o()):(console.log("Закончил печатать..."),setTimeout(function(){$("[data-chat-typing]").fadeOut(),o()},400)))),"viewed"==s.name&&(console.log("Прочитано"),$("[data-comment]").each(function(e){$(this).data("userId")!=s.sender&&$(this).find("[data-comment-status]").text("Прочитано")}))},conn.onclose=function(){console.log("Reconnecting..."),setTimeout(function(){c()},5e3)}}function d(){var e=$("[data-chat-textarea]");return""!=e.val()&&(conn.readyState==SockJS.OPEN&&(conn.send('{"type":"message","message":"'+e.val()+'"}'),void e.val("")))}i&&($("[data-chat-textarea]").focus(),o()),c(),$("[data-chat-form-submit]").click(d),$("[data-chat-textarea]").keydown(function(e){e.ctrlKey&&13==e.keyCode&&d()});var l,u=0;$("[data-chat-textarea]").on("keyup",function(e){e.ctrlKey&&13==e.keyCode||!e.ctrlKey&&17==e.keyCode||(u+=1,1==u&&setTimeout(function(){conn.send('{"type":"typing","typing":"1"}')},300),0!=u&&(l&&clearTimeout(l),l=setTimeout(function(){conn.send('{"type":"typing","typing":"0"}'),u=0},2e3)))}),$("[data-chat-textarea]").on("focusin",function(){console.log("focusin"),conn.send('{"type":"viewed"}')})}function str_triad(e){e+="",e=e.replace(/\s/g,"");var t,a="",s=e.length;for(t=1;3*t<s;t++)a=" "+e.substring(s-3*t,s-3*(t-1))+a;return e=e.substr(0,3-3*t+s)+a}$(document).ready(function(){$("[data-trash]").on("click",function(e){e.preventDefault();var t=$(this).attr("href"),a=$(this);$.ajax({url:t,cache:!1}).done(function(e){if(e.success)if(e.next&&a.closest(".container_action_bar_visible").length){var t=$($(".breadcrumbs__item")[$(".breadcrumbs__item").length-2]).find(".breadcrumbs__link").attr("href");window.location=t}else a.closest(".catalog-item").fadeOut(300,function(){$(this).remove()})})})}),$(function(){$("#add_callback").ajaxForm({type:"post",beforeSubmit:function(){},success:function(e,t,a){if(e.success)$("#add_callback .call_order_form_success").show(),$("#add_callback form")[0].reset(),$("#add_callback .field-alert").removeClass("field-alert"),setTimeout(function(){$("#add_callback .call_order_form_success").fadeOut(),$("#add_callback").find("a.close").click()},1e3);else for(var s in e.fields)$("#add_callback #id_"+e.fields[s]).parent().addClass("field-alert")}})}),$(document).ready(function(){$(".js-cat-wrap").each(function(){var e=$(this);e.hasClass("categories--active")&&e.addClass("categories--active-global")}),$(document).on("click",".js-cat-btn",function(){var e=$(this),t=e.closest(".js-cat-wrap"),a=t.find(".js-cat-list"),s="no";return t.hasClass("categories--active")&&(s="yes"),$(".js-cat-list").each(function(){var e=$(this),t=e.closest(".js-cat-wrap");e.slideUp("100",function(){t.removeClass("categories--active")})}),"no"==s&&a.slideDown("100",function(){t.addClass("categories--active")}),!1})}),$(document).ready(function(){if($(".datepicker").length){var e=$(".datepicker").datepicker({defaultDate:"+1w",changeMonth:!0,changeYear:!0,numberOfMonths:1,dateFormat:"dd.mm.yy",language:"ru",onSelect:function(t){var a=$(this).hasClass("from")?"minDate":"maxDate",s=$(this).data("datepicker"),n=$.datepicker.parseDate(s.settings.dateFormat||$.datepicker._defaults.dateFormat,t,s.settings);e.not(this).datepicker("option",a,n)}});$.datepicker.regional.ru={closeText:"Закрыть",prevText:"&#x3c;Пред",nextText:"След&#x3e;",currentText:"Сегодня",monthNames:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],monthNamesShort:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],dayNames:["воскресенье","понедельник","вторник","среда","четверг","пятница","суббота"],dayNamesShort:["вск","пнд","втр","срд","чтв","птн","сбт"],dayNamesMin:["Вс","Пн","Вт","Ср","Чт","Пт","Сб"],weekHeader:"Нед",dateFormat:"dd.mm.yy",firstDay:1,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},$.datepicker.setDefaults($.datepicker.regional.ru)}}),function(e){e.fn.fill_sorting_href=function(){var t=getUrlVars(),a=get_filtered_url_search(),s=e(".sorting-cabinet:first-child"),n=e(".sorting__order-by:first-child"),i=e(".sorting-cabinet:nth-child(2)"),o=e(".sorting__order-by:nth-child(2)");""!=a?(s.add(n).find("a:first").attr("href",a+"&o=title"),s.add(n).find("a:eq(1)").attr("href",a+"&o=-title"),i.add(o).find("a:first").attr("href",a+"&o=date"),i.add(o).find("a:eq(1)").attr("href",a+"&o=-date")):(s.add(n).add(n).find("a:first").attr("href","?o=title"),s.add(n).find("a:eq(1)").attr("href","?o=-title"),i.add(o).find("a:first").attr("href","?o=date"),i.add(o).find("a:eq(1)").attr("href","?o=-date")),"o"in t?"title"==t.o?(s.add(n).find("a").removeClass("sorting-cabinet--toggle-views-active"),i.add(o).find("a").removeClass("sorting-cabinet--toggle-views-active"),s.add(n).find("a:first").addClass("sorting-cabinet--toggle-views-active")):"-title"==t.o?(s.add(n).find("a").removeClass("sorting-cabinet--toggle-views-active"),i.add(o).find("a").removeClass("sorting-cabinet--toggle-views-active"),s.add(n).find("a:eq(1)").addClass("sorting-cabinet--toggle-views-active")):"date"==t.o?(s.add(n).find("a").removeClass("sorting-cabinet--toggle-views-active"),i.add(o).find("a").removeClass("sorting-cabinet--toggle-views-active"),i.add(o).find("a:first").addClass("sorting-cabinet--toggle-views-active")):"-date"==t.o&&(s.add(n).find("a").removeClass("sorting-cabinet--toggle-views-active"),i.add(o).find("a").removeClass("sorting-cabinet--toggle-views-active"),i.add(o).find("a:eq(1)").addClass("sorting-cabinet--toggle-views-active")):(s.add(n).find("a").removeClass("sorting-cabinet--toggle-views-active"),i.add(o).find("a").removeClass("sorting-cabinet--toggle-views-active"))}}(jQuery),$(document).ready(function(){$(document).fill_sorting_href()}),$(document).ready(function(){$.cookie("geoip_confirm")||$(".geoip__confirm").show(),$(document).on("click",".js-geoip-select",function(){var e=$(this),t=e.closest(".js-geoip-wrap").find(".smart-search"),a=e.attr("data-id"),s=e.text();t.find(".smart-search__search-input").prop("value",""),t.find(".js-search-id").prop("value",a).change(),t.find(".js-text-insert").text(s),t.find(".smart-search__search-text").addClass("filled")}),$(".geoip__confirm a[data-value=yes]").on("click",function(){$(".geoip__confirm").hide(),$.cookie("geoip_confirm","1",{expires:14,path:"/"})})}),$("#id_inn").suggestions({token:"4b01ba9439567734d64241b896c5dd6deb66d6c6",type:"PARTY",count:5,onSelect:function(e){$(this).val(e.data.inn),$("#id_kpp").val(e.data.kpp),$("#id_ogrn").val(e.data.ogrn),$("#id_okpo").val(e.data.okpo),$("#id_okved").val(e.data.okved),$("#id_dir_name").val("management"in e.data?e.data.management.name:e.value)}}),$(document).ready(function(){$("#id_inn").on("keypress",function(e){validate(e)})}),$(document).ready(function(){$("body").prepend("<div class='modal-shadow'></div>"),$(".modal-window").each(function(){var e=$(this);e.find(".modal-window__body").prepend("<a href='' class='closemodal'><span class='icon--close'></span></a>"),e.addClass("js-window"),modalresizer()}),$(document).on("click",".openmodal",function(e){e.preventDefault();var t=$(this),a=t.attr("data-id");t.attr("name")&&(window.offer_company=t.attr("name")),openmodalContent(t,a,window.offer_company)}),$("body").on("click",".closemodal, .modal-shadow",function(e){$(this).trigger("closemodal",["Custom","Event"]),delete window.offer_company,$(".modal-window, .modal-shadow").animate({opacity:0},500,function(){$(".modal-window, .modal-shadow").removeClass("js-active"),$("body").removeClass("overflow-no").css("padding-right","0px"),$(".page-header").css("padding-right","0px")}),e.preventDefault()}),$(".modal-window").length&&$(document).click(function(e){if($(e.target).closest(".modal-window").length){if($(e.target).closest(".modal-window__body").length)return;$(e.target).find(".closemodal").click()}e.stopPropagation()});!function(){var e={}}();$(window).resize(function(){modalresizer()}),$(".modal-window").bind("DOMSubtreeModified",function(){modalresizer()})}),$(function(){$(".g-recaptcha").closest("form").find('button[type="submit"]').attr("disabled","disabled")}),$(function(){$("form.quick_order").ajaxForm({type:"post",data:{},beforeSubmit:function(e,t,a){var s=t[0];console.log("ORDER2",window.offer_company),this.data.offer_company=window.offer_company,$(s).find(".loader").addClass("loader--show"),$(s).find(".errors").hide().remove()},success:function(e,t,a,s){if(e.success)$(s).hide().prev(".call_order_form_success").show(),e.auth&&$("body").on("closemodal",function(){location.href="/accounts/order/"+e.order_id});else if(e.error){var n=$(".box--err").empty();grecaptcha.reset();for(var i in e.fields)$(s).find("#id_"+i).addClass("err"),"captcha"==i?n.show().append("<p>"+error_messages[i]+"</p>"):n.show().append("<p>"+error_messages[i]+e.fields[i]+"</p>")}else console.log("Unexpected error")}}),$("form#index_quick_order").ajaxForm({type:"post",data:{},beforeSubmit:function(e,t,a){var s=t[0];$(".box--err").empty();var n=$(s).find("button.request-btn");n.attr("disabled","disabled"),n.addClass("btn--disabled")},success:function(e,t,a,s){var n=$(s).find("button.request-btn");if(n.removeAttr("disabled"),n.removeClass("btn--disabled"),e.success)openmodal("order_success"),e.auth&&$("body").on("closemodal",function(){location.href="/accounts/order/"+e.order_id});else if(e.error){$(".box--err").empty();grecaptcha.reset();for(var i in e.fields)$(s).find("#id_"+i).addClass("err")}else console.log("Unexpected error")}})});var error_messages={captcha:"Вы не ввели капчу",email:'Поле "E-mail": ',name:'Поле "Имя": ',phone:'Поле "Контактный телефон": ',title:'Поле "Название заказа": ',description:'Поле "Описание заказа": '};if($("#item-search").length){$(document).on("click",".color",function(){var e=$(this).find("input");e.prop("checked")?$(this).find(".state.active").hide():$(this).find(".state.active").show(),e.prop("checked",!e.prop("checked")),e.trigger("change")});var $range=$("#range_price"),slider;$(document).on("keyup",'input[name="min_price"],input[name="max_price"]',function(e){13==e.keyCode&&$(this).trigger("blur")}),$(document).on("blur",'input[name="min_price"],input[name="max_price"]',function(){slider.update({from:parseInt($('input[name="min_price"]').val()),to:parseInt($('input[name="max_price"]').val())}),animate_flag=1,$("[data-filter-form]").trigger("submit")});var animate_flag=0;$(document).ready(function(){$("#range_price").length>0&&show_range_slider(),$(document).pjax(".pagination a","#item-search",{push:!0,replace:!1,timeout:5e3,scrollTo:!1}),$(document).pjax(".sorting-cabinet a","#item-search",{push:!0,replace:!1,timeout:5e3,scrollTo:!1}),$(document).pjax(".filter-top a","#item-search",{push:!0,replace:!1,timeout:5e3,scrollTo:!1})}),$(document).on("change","input[type=checkbox], [data-filter-form] select, .smart-search input[type=hidden]",function(){"want_copies"!=$(this).attr("name")&&($("[data-filter-form]").trigger("submit"),animate_flag=0)}),$(document).on("change","[data-material-search] input",function(){$("[data-material-search]").trigger("submit"),animate_flag=0}),$(document).on("change","[data-material-line] select",function(){$("[data-material-line]").trigger("submit"),animate_flag=0}),$(document).on("pjax:send",function(e,t){var a=$("#item-search"),s=a.offset();a.html('<div class="loading" ></div><br/><br/>'),$("body, html").animate({scrollTop:s.top-145},"500","swing")}),$(document).on("pjax:success",function(e,t,a,s){$(document).fill_sorting_href()}),$(document).on("submit","[data-filter-form]",function(e){$.pjax.submit(e,"#item-search",{push:!0,replace:!1,timeout:5e3,scrollTo:!1})}),$(document).on("submit","[data-material-search]",function(e){$.pjax.submit(e,"#item-search",{push:!0,replace:!1,timeout:5e3,scrollTo:!1})}),$(document).on("submit","[data-material-line]",function(e){$.pjax.submit(e,"#item-search",{push:!0,replace:!1,timeout:5e3,scrollTo:!1})})}$(document).ready(function(){$(document).on("change",".js-checkshow-checkbox",function(){var e=$(this),t=e.attr("data-id"),a=e.closest(".js-checkshow-wrap"),s=a.find(".js-checkshow-show");1==e.prop("checked")?(s.show(300,"linear",function(){}),"unsubscribe"==t&&$(".js-check-notice").each(function(){var e=$(this);e.find(".pseudo-check__real").prop("disabled","disabled"),e.addClass("pseudo-check--disabled")})):(s.hide(300,"linear",function(){}),"unsubscribe"==t&&$(".js-check-notice").each(function(){var e=$(this);e.find(".pseudo-check__real").removeAttr("disabled"),e.removeClass("pseudo-check--disabled")}))})}),$(document).ready(function(){$(document).on("change",".pseudo-check__real",function(){var e=$(this),t=e.closest(".pseudo-check");1==e.prop("checked")?t.addClass("check"):t.removeClass("check")})}),$(document).ready(function(){$(".pseudo-select").length&&$(document).click(function(e){$(e.target).closest(".pseudo-select").length||($(".pseudo-select__list").removeAttr("style"),$(".pseudo-select").removeClass("pseudo-select--active"),e.stopPropagation())}),$(document).on("click",".pseudo-select__control",function(){var e=$(this).closest(".pseudo-select"),t="no";e.hasClass("pseudo-select--active")&&(t="yes"),$(".pseudo-select").removeClass("pseudo-select--active"),$(".pseudo-select__list").removeAttr("style"),"yes"==t?(e.removeClass("pseudo-select--active"),e.find(".pseudo-select__list").removeAttr("style")):(e.addClass("pseudo-select--active"),e.find(".pseudo-select__list").css("display","block"))}),$(document).on("click",".pseudo-select__option",function(){var e=$(this),t=e.closest(".pseudo-select"),a=e.text(),s=e.attr("data-value");t.find(".pseudo-select__option").removeClass("current"),e.addClass("current"),t.find(".pseudo-select__text").text(a),t.find(".pseudo-select__list").removeAttr("style"),t.find(".pseudo-select__real option").removeAttr("selected"),t.removeClass("pseudo-select--active"),t.find('.pseudo-select__real option[value="'+s+'"]').attr("selected","selected").change(),t.find(".pseudo-select__real").val(s)}),$(document).on("change",".pseudo-select__real",function(){var e=$(this),t=e.val(),a=e.closest(".pseudo-select");if(t!=a.find(".pseudo-select__option.current").attr("data-value")){var s=e.find("option[value='"+t+"']").text();a.find('.pseudo-select__real option[value="'+t+'"]').attr("selected","selected"),a.find(".pseudo-select__option").removeClass("current"),a.find(".pseudo-select__option[data-value='"+t+"']").addClass("current"),a.find(".pseudo-select__text").text(s)}})}),$(document).ready(function(){$(document).on("click",".pseudo-upload",function(){$(this).next("input[type=file]").click()}),$("form#send_contract input[type=file]").on("change",function(){$("#send_contract").submit()})}),$(document).ready(function(){$(".request-phone").length&&$(".request-phone").mask("+7 (999) 999-99-99");var e=$(".page-header"),t=e.outerHeight();$(window).resize(function(){t=e.outerHeight()}),$(document).on("click","a.ancLinks",function(){var e=$(this).attr("href"),a=$(e).offset().top-t;return $("html:not(:animated),body:not(:animated)").animate({scrollTop:a},500),!1}),$(document).on("click",".js-menu-adaptive-btn, .js-menu-adaptive-close",function(e){$("body").hasClass("overflow-no")?($(".js-menu-adaptive-list").fadeOut(0),$(".js-menu-adaptive-close").css("right","0px"),$("body").removeClass("overflow-no").css("padding-right","0px"),$(".page-header").css("padding-right","0px")):($(".js-menu-adaptive-list").fadeIn(400),$("body").addClass("overflow-no").css("padding-right",scrollbarWidth()),$(".page-header").css("padding-right",scrollbarWidth()),$(".js-menu-adaptive-close").css("right",scrollbarWidth())),e.preventDefault()}),$(document).on("click",".btn--disabled",function(){return!1}),$(document).on("click",".js-tab-btn",function(){var e=$(this),t=e.closest(".js-tab"),a=e.attr("data-tab");t.find(".js-tab-content").removeClass("current"),t.find(".js-tab-content[data-tab="+a+"]").addClass("current"),t.find(".js-tab-btn").removeClass("current"),e.addClass("current")}),$(".js-slider-main").slick({dots:!1,arrows:!1,speed:3e4,slidesToShow:1,slidesToScroll:1,autoplay:!0,autoplaySpeed:0,cssEase:"linear"}),$(document).on("click",".js-faq-btn",function(){var e=$(this),t=e.closest(".js-faq-wrap");return t.find(".js-faq-body").slideToggle("100",function(){t.hasClass("faq--active")?t.removeClass("faq--active"):t.addClass("faq--active")}),!1}),$(document).on("click",".js-expand-btn",function(){var e=$(this),a=e.attr("data-expand"),s=e.closest(".js-expand-wrap"),n=e.attr("data-id");if(n){var i=s.find(".js-expand-body[data-id="+n+"]");s.find(".js-expand-body").each(function(){var e=$(this);if(!e.hasClass("js-expand-body-nohidden")){e.attr("data-id")!=n&&e.hide()}})}else i=s.find(".js-expand-body");return i.slideToggle("400",function(){if(e.hasClass("active")?e.removeClass("active"):e.addClass("active"),"show"==a&&(e.hasClass("js-expand-inherit-hidden")?(s.find(".js-expand-show[data-id="+n+"]").hide(),s.find(".js-expand-hidden[data-id="+n+"]").show()):(s.find(".js-expand-show").hide(),s.find(".js-expand-hidden").show())),"block"==i.css("display")){var o=i.offset().top-t;$("html:not(:animated),body:not(:animated)").animate({scrollTop:o},500)}$(".js-show-more-wrap").each(function(){show_more($(this))})}),"hidden"==a&&(e.hasClass("js-expand-inherit-hidden")?(s.find(".js-expand-hidden[data-id="+n+"]").hide(),s.find(".js-expand-show[data-id="+n+"]").show()):(s.find(".js-expand-hidden").hide(),s.find(".js-expand-show").show())),!1}),$(document).on("click",".js-confirm-win-btn",function(){var e=$(this),t=e.closest(".js-confirm-win-wrap"),a=t.find(".js-confirm-win-modal");return $(".js-confirm-win-modal").css({display:"none"}),a.fadeIn(400),!1}),$(document).on("click",".js-confirm-win-btn-no",function(){return $(".js-confirm-win-modal").fadeOut(400),!1}),$(".js-confirm-win-modal").length&&$(document).click(function(e){$(e.target).closest(".js-confirm-win-modal").length||($(".js-confirm-win-modal").fadeOut(400),e.stopPropagation())}),$(document).on("click",".js-order-mark-star",function(){var e=$(this),t=e.closest(".js-order-mark"),a=e.attr("data-star"),s=t.find(".js-order-mark-res");t.find(".js-order-mark-star").each(function(){var e=$(this);e.attr("data-star")<=a?e.addClass("active"):e.removeClass("active")}),s.val(a)}),$(".js-order-mark-star").hover(function(e){var t=$(this),a=t.closest(".js-order-mark"),s=t.attr("data-star");a.find(".js-order-mark-star").each(function(){var e=$(this);e.attr("data-star")<=s?e.css("color","#f98500"):e.removeAttr("style")})},function(e){$(this).closest(".js-order-mark").find(".js-order-mark-star").each(function(){$(this).removeAttr("style")})}),$(document).on("click",".js-stone-check",function(){var e=$(this),t=e.closest(".js-stone-check-wrap");t.find(".js-stone-prices").slideToggle("400",function(){t.hasClass("check")?t.removeClass("check"):t.addClass("check")})}),$(function(){$("#slider-range").slider({range:!0,min:0,max:500,values:[75,300],slide:function(e,t){$("#amount").val("$"+t.values[0]+" - $"+t.values[1])}}),$("#amount").val("$"+$("#slider-range").slider("values",0)+" - $"+$("#slider-range").slider("values",1))}),$(".filter-top__item").on("click",function(){var e=$(".smart-search"),t=$(this);$(".filter-top__item").removeClass("filter-top--active"),t.addClass("filter-top--active"),$.ajax({url:"/materials/lines/",data:{production:t.data("id")},success:function(t){e.html(t)}})})}),$(document).ready(function(){$(".js-show-more-wrap").each(function(){show_more($(this))}),$(window).resize(function(){$(".js-show-more-wrap").each(function(){show_more($(this))})}),$(document).on("click",".js-show-more-btn",function(){var e=$(this),t=e.closest(".js-show-more-wrap"),a=(t.find(".js-show-more-text"),"no");return t.hasClass("open")&&(a="yes"),"yes"==a?(t.removeClass("open").addClass("close"),e.text("Показать полностью")):(t.addClass("open").removeClass("close"),e.text("Свернуть")),!1})}),$(document).ready(function(){$(".js-responsive-productcard").slick({dots:!0,infinite:!0,speed:300,slidesToShow:4,slidesToScroll:4,responsive:[{breakpoint:1200,settings:{slidesToShow:3,slidesToScroll:3,infinite:!0,dots:!0}},{breakpoint:992,settings:{slidesToShow:2,slidesToScroll:2,infinite:!0,dots:!0}},{breakpoint:768,settings:{slidesToShow:1,slidesToScroll:1}},{breakpoint:576,settings:{slidesToShow:1,slidesToScroll:1}}]})}),$(document).ready(function(){$(".js-search-id").length&&$(".js-search-id").each(function(){var e=$(this),t=e.closest(".smart-search__search"),a=t.find(".smart-search__search-text");""!=e.val()&&a.append("<div class='smart-search__search-icon smart-search--search-close icon--close js-search-close'></div>")}),$(document).on("click",".js-search-close",function(){var e=$(this),t=e.closest(".smart-search"),a=t.find(".js-text-insert"),s=a.attr("data-default-text"),n=t.find(".js-search-id");return a.text(s),n.val(""),e.remove(),!1}),$(".smart-search").length&&$(document).click(function(e){$(e.target).closest(".smart-search__search").length||($(".smart-search__search-result").removeClass("block"),$(".smart-search__search-wrap").removeClass("block"),e.stopPropagation())}),$(document).on("click",".smart-search__search-text",function(){var e=$(this),t=e.closest(".smart-search");$(".smart-search__search-wrap").removeClass("block"),t.find(".smart-search__search-wrap").addClass("block"),t.find(".smart-search__search-input").click(),t.find(".smart-search__search-input").focus()}),$(document).on("propertychange input click",".smart-search__search-input",function(){var e=$(this);if(e.hasClass("process"))return!1;e.addClass("process");var t=e.closest(".smart-search"),a=t.find(".smart-search__search-result"),s=t.attr("data-id");a.addClass("block");var n=e.val().toLowerCase(),i="no";if(t.find(".js-ajax").length>0){var o=t.find(".js-ajax").text();if("yes"==(i=""!=o?0==n.indexOf(o)?"no":"yes":"no")){var r=t.attr("data-ajax-url");$.get(r,{startswith:n.substring(0,1)},function(a){if(a.items){var s="";s+="<ul>";for(var i=0;i<a.items.length;i++)for(var o=0;o<a.items[i].children.length;o++)s=s+'<li class="smart-search__item active ininput" data-id="'+a.items[i].children[o].id+'">'+a.items[i].children[o].text+", "+a.items[i].text+"</li>";s+='<li class="smart-search__item smart-search--item-empty">Результатов не найдено</li>',s+="</ul>",t.find(".smart-search__search-result").html(s);var r="yes";t.find(".smart-search__item").each(function(){var e=$(this);0==e.text().toLowerCase().indexOf(n)?(e.removeClass("hidden"),r="no"):e.addClass("hidden"),"yes"==r?t.find(".smart-search--item-empty").removeClass("hidden"):t.find(".smart-search--item-empty").addClass("hidden")}),t.find(".js-ajax").text(n.substring(0,1))}if(""==n&&(t.find(".js-ajax").text("no empty"),t.find(".smart-search__search-result").html("")),t.find(".smart-search__selected-list").length>0){var c=[],d=0;t.find(".smart-search__selected-wrap").each(function(){var e=$(this),t=e.attr("data-id");c[d]=t,d++}),t.find(".smart-search__item").each(function(){var e=$(this);if(!e.hasClass("smart-search--item-empty")){var t=e.attr("data-id");-1==$.inArray(t,c)?e.addClass("active"):e.removeClass("active")}})}else{var c=[];c[0]=t.find(".js-search-id").val(),t.find(".smart-search__item").each(function(){var e=$(this);if(!e.hasClass("smart-search--item-empty")){var t=e.attr("data-id");-1==$.inArray(t,c)?e.addClass("active"):e.removeClass("active")}})}e.removeClass("process"),n!=e.val().toLowerCase()&&e.click()},"json")}}if(""!=n&&"no"==i){var c="yes";t.find(".smart-search__item").each(function(){var e=$(this),a=e.text().toLowerCase();"city"==s&&(a=a.split(","),a=a[0]),-1!=a.indexOf(n)?(e.removeClass("hidden"),c="no"):e.addClass("hidden"),"yes"==c?t.find(".smart-search--item-empty").removeClass("hidden"):t.find(".smart-search--item-empty").addClass("hidden")})}if(""==n&&"no"==i&&(t.find(".smart-search__item").each(function(){$(this).removeClass("hidden")}),t.find(".smart-search--item-empty").addClass("hidden"),t.find(".js-ajax").text("no empty")),"no"==i){if(t.find(".smart-search__selected-list").length>0){var d=[],l=0;t.find(".smart-search__selected-wrap").each(function(){var e=$(this),t=e.attr("data-id");d[l]=t,l++}),t.find(".smart-search__item").each(function(){var e=$(this);if(!e.hasClass("smart-search--item-empty")){var t=e.attr("data-id");-1==$.inArray(t,d)?e.addClass("active"):e.removeClass("active")}})}else{var d=[];d[0]=t.find(".js-search-id").val(),t.find(".smart-search__item").each(function(){var e=$(this);if(!e.hasClass("smart-search--item-empty")){var t=e.attr("data-id");-1==$.inArray(t,d)?e.addClass("active"):e.removeClass("active")}})}e.removeClass("process"),n!=e.val().toLowerCase()&&e.click()}}),$(document).on("click",".smart-search__item.active.ininput",function(){var e=$(this),t=e.closest(".smart-search"),a=t.attr("data-id"),s=e.text(),n=e.attr("data-id");"city"==a&&(s=s.split(","),s=s[0]),t.find(".smart-search__search-input").prop("value",""),t.find(".js-search-id").prop("value",n).change(),t.find(".js-text-insert").text(s),t.find(".smart-search__search-text").append("<div class='smart-search__search-icon smart-search--search-close icon--close js-search-close'></div>"),t.find(".js-ajax").length>0?t.find(".smart-search__search-result").html("").removeClass("block"):t.find(".smart-search__search-result").removeClass("block"),t.find(".smart-search__search-wrap").removeClass("block"),t.find(".smart-search__search-text").addClass("filled")}),$(document).on("click",".smart-search__item.active.multy",function(){var e=$(this),t=e.closest(".smart-search"),a=t.attr("data-id"),s=e.text(),n=e.attr("data-id");t.find(".smart-search__selected-list").append('<div class="smart-search__selected-wrap" data-id="'+n+'"><div class="smart-search__selected-block"><span class="smart-search__selected-icon icon--right-open-mini"></span><div class="smart-search__selected-name">'+s+'</div><input type="hidden" name="'+a+'" value="'+n+'" /><div class="smart-search__selected-del icon--delete"></div></div></div>'),t.find(".smart-search__search-input").prop("value",""),t.find(".js-search-id").prop("value",""),t.find(".js-ajax").length>0?t.find(".smart-search__search-result").html("").removeClass("block"):t.find(".smart-search__search-result").removeClass("block"),t.find(".smart-search__search-wrap").removeClass("block"),1==t.find(".smart-search__selected-wrap").length&&t.find(".smart-search__selected-title").removeClass("hidden")}),$(document).on("click",".smart-search__selected-del",function(){var e=$(this),t=e.closest(".smart-search"),a=e.closest(".smart-search__selected-wrap"),s=a.attr("data-id"),n=e.closest(".smart-search__selected-list");n.find(".smart-search__selected-wrap[data-id='"+s+"']").remove(),""==n.html().replace(/^\s*/,"").replace(/\s*$/,"")&&t.find(".smart-search__selected-title").addClass("hidden")})});var js_settings=$("#js_settings"),sockjs_enable=js_settings.data("sockjs_enable"),url=js_settings.data("sockjs_url"),port=js_settings.data("sockjs_port"),timezone=getCookie("timezone");null==timezone&&setCookie("timezone",jstz.determine().name());var conn;$(document).ready(function(){var e=$("#chat_settings"),t=e.data("thread_id"),a=e.data("email"),s=e.data("total"),n=e.data("sent"),i=e.data("received");sockjs_enable&&activate_chat(t,a,{total:s,sent:n,received:i},url,port,e.length)}),$(document).ready(function(){$(document).on("propertychange input",".js-triad",function(){var e=$(this),t=e.val().replace(/\s/g,""),a=t,s=/^[0-9]+$/i;if(0!=t.search(s)&&((a=parseInt(t.replace(/\D+/g,"")))||(a="")),a=str_triad(a),e.val(a),"sum"==e.attr("data-order")){var n=e.closest(".js-order-sum-wrap").find(".js-order-sum-res"),i=1*a.replace(/\s/g,"");e.attr("data-sum",i);var o=0;e.closest(".js-order-sum-wrap").find(".js-triad").each(function(){var e=$(this);o+=1*e.attr("data-sum")}),n.text(str_triad(o))}if("sum-price"==e.attr("data-order")||"sum-count"==e.attr("data-order")){var n=e.closest(".js-order-sum-wrap").find(".js-order-sum-res"),i=1*a.replace(/\s/g,"");e.attr("data-count",i);var o=e.closest(".js-order-sum-wrap").find(".js-triad[data-order='sum-price']").attr("data-count")*e.closest(".js-order-sum-wrap").find(".js-triad[data-order='sum-count']").attr("data-count");n.text(str_triad(o))}}),$(document).on("click",".js-triad",function(){0==1*$(this).val()&&$(this).val("")}),$(document).on("blur",".js-triad",function(){""==$(this).val()&&$(this).val("")})}),$(document).ready(function(){var e=$(".uploadformset");e.length&&e.each(function(e){$($(this).data("formset-elements")).uploadformset({prefix:$(this).data("formset-prefix"),deleteText:"",addText:"",ajaxUploadFileId:$(this).data("formset-ajaxuploadfileid"),formCssClass:$(this).data("formset-formcssclass"),allowedFileExtensions:$(this).data("formset-allowedfileextensions").split(",")})});var t=$(".uploadform-data");t.length&&t.each(function(e){$($(this).data("id-label")).uploadform({allowedFileExtensions:$(this).data("formset-allowedfileextensions")})});var a=$(".uploadform-data-prefix");a.length&&a.each(function(e){$($(this).data("id-field")).uploadform({allowedFileExtensions:"",ajaxUploadFileId:$(this).data("formset-ajaxuploadfileid")})})});